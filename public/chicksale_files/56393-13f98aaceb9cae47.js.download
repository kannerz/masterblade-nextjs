"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[56393],{95474:function(e,t,r){var n=r(68930),o=r(26248),c=r(38955),i=r(25313),a=r(77491);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var d=e=>s(s({},(0,a.h)(e)),{},{component:"chat",et:"click",s:"contact"}),p=e=>{_kd.push([e.t,e])},l=()=>{var e=(0,o.aF)(),t=(0,c.useCallback)(t=>{var r,{ad:n,chatType:o,badges:c}=t,u=o.toUpperCase().replace(" ","_"),l=s(s({},d(t)),{},{memberId:null==e?void 0:e.memberId,t:u});c&&(l.badges=c),p((0,a.A)(l)),(0,i.Z)("CONTACT",{category:n.category.nameEn,contact_type:"chat",external_id:String(null!==(r=null==e?void 0:e.memberId)&&void 0!==r?r:0)})},[null==e?void 0:e.memberId]),r=(0,c.useCallback)(t=>{var r,{ad:n,badges:o}=t,c=s(s({},d(t)),{},{memberId:null==e?void 0:e.memberId,t:"CHAT_LISTING"});o&&(c.badges=o),p((0,a.A)(c)),(0,i.Z)("CONTACT",{category:n.category.nameEn,contact_type:"chat",external_id:String(null!==(r=null==e?void 0:e.memberId)&&void 0!==r?r:0)})},[null==e?void 0:e.memberId]);return{sendTrackingChatClick:t,sendTrackingChatListingClick:r}};t.Z=l},42102:function(e,t,r){var n,o;r.d(t,{J:function(){return n}}),(o=n||(n={})).FavoriteList="FAVORITE_LIST",o.Favorited="FAVORITED",o.Unfavorited="UNFAVORITED"},25313:function(e,t,r){r.d(t,{Z:function(){return i}});var n=r(30983),o=r(23809),c=r(59294);function i(e,t){return a.apply(this,arguments)}function a(){return(a=(0,n.Z)(function*(e,t){if(!o.IS_SERVER&&(0,c.S)()){var{logCustomEvent:n}=yield r.e(85178).then(r.bind(r,85178));n(e,t)}})).apply(this,arguments)}},13582:function(e,t,r){var n=r(23809),o=r(9459),c=e=>{var{user:t,adId:r,text:c,buyerId:i}=e;if(!n.NEXT_PUBLIC_MAIN_URL)throw Error("No main Kaidee domain provided");return(0,o._)({adId:r,buyerId:i,chatDomain:n.CHAT_DOMAIN,kaideeDomain:n.NEXT_PUBLIC_MAIN_URL,system:"KAIDEE",text:c,user:t})};t.Z=c},94626:function(e,t,r){var n=r(68930),o=r(95869),c=r(92013);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var u=e=>{var{ad:t,customVariables:r={},pixelTrackingSection:n,userId:i}=e;o.Z.trigger("login_chat_attempt",a(a({},(0,c.Z)({ad:t,pixelTrackingSection:n,userId:i})),r))};t.Z=u},9854:function(e,t,r){var n=r(68930),o=r(95869),c=r(92013);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}t.Z=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};o.Z.trigger("login_chat_success",a(a({},(0,c.Z)({ad:t,pixelTrackingSection:e,userId:r})),n))}},50714:function(e,t,r){r.d(t,{Z:function(){return s}});var n=r(68930),o=r(95869),c=r(92013),i=r(90752);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e){var{pageSection:t,listingPageType:r,ad:n,userId:a,customVariables:s={},subBusiness:d,websiteSection:p}=e;o.Z.trigger("chat_lead",u(u(u(u({},(0,c.Z)({ad:n,userId:a})),(0,i.Z)({enhancement:n.enhancement,themes:n.themes})),s),{},{listing_pagetype:r,page_section:t,sub_business:d,website_section:p}))}},77491:function(e,t,r){r.d(t,{A:function(){return a},h:function(){return u}});var n=r(68930),o=e=>({adId:e.legacyId,categoryId:e.category.id,sellerId:e.member.id});function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var a=e=>{var{adId:t,memberId:r,categoryId:n,detail:o,sellerId:c,sourceId:i,index:a,pageSource:u,section:s,position:d,component:p,t:l,s:b,et:f,suggest:O,badges:m}=e,y="".concat(n),g="".concat(t),v={adId:g,ad_id:g,adid:g,bucket:b,c:y,categoryId:y,category_id:y,component:p,detail:o,et:f,eventType:f,index:"".concat(a),page_source:u,position:d,s:b,section:s,seller_id:"".concat(c),source_id:i,t:l};return void 0===r?(v.mid="0",v.memberId="0"):(v.mid="".concat(r),v.memberId="".concat(r)),void 0!==O&&(v.suggest=O),m&&(v.badges=m),v},u=e=>{var{tracking:t}=e,{detail:r="",index:n=0,pageSource:c,position:a,section:u,suggest:s,uniqueId:d,s:p="enga.ad_card",t:l="AD_CARD"}=t;return i(i({},o(e.ad)),{},{detail:r,index:n,pageSource:c,position:a,s:p,section:u,sourceId:d,suggest:s,t:l})}},22227:function(e,t,r){r.d(t,{Z:function(){return p}});var n,o,c=r(30983),i=r(68930),a=r(46215);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var d=(n=(0,c.Z)(function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return yield(0,a.Z)("/ads_favorite/".concat(e.itemId,"/").concat(e.isFavorite?"favorite":"unfavorite"),e,s(s({},t),{},{profilerLabel:"Server.API.toggleFavoriteFromListAndDetail"}))}),function(e){return n.apply(this,arguments)}),p=(o=(0,c.Z)(function*(e,t){var{isFavorite:r,adId:n}=e,o=yield d({isFavorite:r,itemId:n},{memberId:t.memberId,privateToken:t.ac});if("fail"===o.status)throw Error(o.error_type);return{results:{adId:o.results.ad_id,id:o.results.id,memberId:o.results.member_id},status:o.status}}),function(e,t){return o.apply(this,arguments)})},31962:function(e,t,r){var n=r(30983),o=r(70792),c=r(38955),i=r(96973),a=e=>{var t,r,{0:a,1:u}=(0,c.useContext)(i.p),{chatRooms:s,currentRoom:d}=a,{0:p,1:l}=(0,c.useState)(0),{0:b,1:f}=(0,c.useState)(o.Jt.All),O=(t=(0,n.Z)(function*(t,r){l(0),f(t);var n=yield(0,o.As)({memberId:r.memberId,ac:r.ac},{roomType:t,page:0,chatHostDomain:e});return u({type:"UPDATE_CHAT_ROOMS",payload:n}),n}),function(e,r){return t.apply(this,arguments)}),m=(r=(0,n.Z)(function*(t){var r=p+1;l(r),u({type:"UPDATE_CHAT_ROOMS",payload:[...null!=s?s:[],...yield(0,o.As)({memberId:t.memberId,ac:t.ac},{roomType:b,page:r,chatHostDomain:e})]})}),function(e){return r.apply(this,arguments)}),y=e=>O(o.Jt.All,e);return{chatRooms:s,currentRoom:d,fetchFilteredChatRooms:O,fetchMoreChatRooms:m,reloadChatRooms:y}};t.Z=a},9459:function(e,t,r){r.d(t,{_:function(){return l},n:function(){return p}});var n,o,c=r(30983),i=r(70792),a=r(56480),u=r(28478),s=(e,t,r)=>{var{width:n,height:o}=e;n>o?n>t&&(o*=t/n,n=t):o>r&&(n*=r/o,o=r);var c=document.createElement("canvas");c.width=n,c.height=o;var i=c.getContext("2d");return null==i||i.drawImage(e,0,0,n,o),{width:n,height:o,url:c.toDataURL("image/png")}},d=e=>new Promise(t=>{var r=new Image;r.onload=function(){var e=s(r,200,200),n=s(r,1e3,1e3);t({thumbnail:e,large:n})},r.src=window.URL.createObjectURL(e)}),p=(n=(0,c.Z)(function*(e,t,r,n){var{memberId:o}=r,c={messageId:"",receiverIds:[],text:e,roomId:t,senderId:o,uniqueId:(0,a.pW)(),_status:"SENDING",tags:[],createdTime:Date.now().toString(),uploadPercent:100};if(n){var i=yield d(n),s={id:0,name:"",order:0,width:i.large.width,height:i.large.height,thumb:String(i.thumbnail.url),medium:String(i.large.url),large:String(i.large.url)};return(0,u.ZP)(c,e=>{e.uploadFile=n,e.uploadPercent=0,e.attachImage=(0,a.m$)(s)})}return c}),function(e,t,r,o){return n.apply(this,arguments)}),l=(o=(0,c.Z)(function*(e){var{user:t,adId:r,chatDomain:n,kaideeDomain:o,text:c="",system:a="KAIDEE",buyerId:u}=e,s=yield(0,i.yR)({memberId:t.memberId,ac:t.ac},{buyer:{member_id:u||t.memberId},product:{item_id:r,system:a}},n),d="".concat(o,"/messages/").concat(s.roomId);if(c){var l=yield p(c,s.roomId,t);return yield(0,i.Ke)({memberId:t.memberId,ac:t.ac},l,()=>{},n),{url:d,chatRoom:s,message:l}}return{url:d,chatRoom:s,message:void 0}}),function(e){return o.apply(this,arguments)})}}]);