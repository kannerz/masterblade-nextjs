"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[15565],{84752:function(e,t,r){var a,n,l=r(38955);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var s=e=>l.createElement("svg",o({width:"1em",height:"1em",viewBox:"0 0 29 29",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),a||(a=l.createElement("circle",{cx:14.5,cy:14.5,r:14.5,fill:"#25C4C4"})),n||(n=l.createElement("path",{d:"M10.4 20.414a1.626 1.626 0 0 0 1.908-.37l9.14-9.138.026-.027.025-.029a1.624 1.624 0 0 0-.044-2.166l-.731.682.706-.708a1.625 1.625 0 0 0-2.295 0l-7.922 7.907-1.395-1.589-.006-.006a1.625 1.625 0 0 0-2.43 2.157l2.492 2.884c.146.17.325.306.526.403Z",fill:"#fff",stroke:"#fff",strokeWidth:2})));t.Z=s},75743:function(e,t,r){r.d(t,{Z:function(){return K}});var a,n,l,o=r(84486),s=r(38955),i=r(67641),c=r(30983),u=r(92361),m=r(38753),d=r(57496),p=r(76502),f=r(63990),b=r(92998),v=r(36502),h=r(26327).ZP.input.withConfig({componentId:"sc-j4mzyb-0"})(["",""],b.Z),g=e=>{var{onSelect:t,isSelected:r,phoneNumber:a}=e;return s.createElement("div",{className:(0,v.Z)("flex w-full items-center border border-t-0 border-r-0 border-l-0 border-sl125 p-md hover:cursor-pointer hover:bg-p005 ",r&&"bg-p005"),onClick:t},s.createElement(h,{checked:r,onClick:t,type:"radio"}),s.createElement("span",{className:" text-body-4 text-sd125"},a))},y=r(69429),E=r(75669),x=e=>{var{children:t,onCloseModal:r,isErrorShown:a,handleCloseErrorToast:n,errorMessage:l="พบข้อผิดพลาดในการเชื่อมต่อ กรุณาลองใหม่อีกครั้ง"}=e;return s.createElement("div",{className:"relative bg-sl100 px-lg pt-3xl pb-xl md:w-[616px]"},s.createElement(y.Z,{isShown:a,mode:"error",onClose:n,position:"bottom-center"},l),s.createElement("div",{className:"absolute top-md right-md cursor-pointer p-sm","data-testid":"close-call-back-modal",onClick:r},s.createElement(E.Z,{height:"24px",width:"24px"})),t)},N=r(33835),w=r(13582),I=r(88939),Z=(a=(0,c.Z)(function*(e){var{categoryId:t,categoryRootId:r,adId:a,sellerId:n,sellerPhoneNumber:l,userInformation:o,buyerPhoneNumber:s}=e,{chatRoom:i}=yield(0,w.Z)({adId:a,user:o});yield(0,N.Z)(o,{adId:a,buyerId:o.memberId,buyerPhoneNumber:s,popUpName:"notify_by_sms_pop_up",roomId:i.roomId,sellerId:n,sellerPhoneNumber:l,vertical:(0,I.L)({id:t,rootId:r})})}),function(e){return a.apply(this,arguments)}),_=e=>{switch(e){case"otp_not_expire":return"รหัสยืนยันหมดอายุ กรุณาลองใหม่อีกครั้ง";case"status_block_member":return"คุณไม่สามารถลงขายได้ กรุณาติดต่อทีมงาน";default:return"พบข้อผิดพลาดในการเชื่อมต่อ กรุณาลองใหม่อีกครั้ง"}},k=r(42806),S=(n=(0,c.Z)(function*(e,t){return yield(0,k.Z)({mobile:e,type:2},{memberId:t.memberId})}),function(e,t){return n.apply(this,arguments)}),C=e=>{var t,r,{adId:a,categoryId:n,categoryRootId:l,onGenerateOtp:o,onSuccess:i,sellerId:u,sellerPhoneNumber:m,userInformation:d}=e,{0:p,1:f}=(0,s.useState)(!1),{0:b,1:v}=(0,s.useState)(""),{0:h,1:g}=(0,s.useState)(!1),y=(t=(0,c.Z)(function*(e){g(!0);try{yield Z({adId:a,buyerPhoneNumber:e,categoryId:n,categoryRootId:l,sellerId:u,sellerPhoneNumber:m,userInformation:d}),i(),g(!1)}catch(t){v("ระบบไม่สามารถให้บริการได้ในขณะนี้"),f(!0),g(!1)}}),function(e){return t.apply(this,arguments)}),E=(r=(0,c.Z)(function*(e){g(!0);try{var{status:t,errorType:r,message:a}=yield S(e,d);if("fail"===t){var n=null!=a?a:_(r);v(n),f(!0),g(!1);return}o(),g(!1)}catch(l){v("ระบบไม่สามารถให้บริการได้ในขณะนี้"),f(!0),g(!1)}}),function(e){return r.apply(this,arguments)}),x=e=>{var{phoneNumberInput:t,phoneNumberSelect:r}=e;return r?y(r):E(t)},N=()=>{f(!1)};return{errorMessage:b,handleCloseErrorToast:N,handleFormSubmit:x,isErrorShown:p,isLoading:h}},P=e=>{var{adId:t,categoryId:r,categoryRootId:a,sellerId:n,sellerPhoneNumber:l,userInformation:o,onCloseModal:c,onSuccess:b,onGenerateOtp:v}=e,{isErrorShown:h,isLoading:y,handleFormSubmit:E,errorMessage:N,handleCloseErrorToast:w}=C({adId:t,categoryId:r,categoryRootId:a,onGenerateOtp:v,onSuccess:b,sellerId:n,sellerPhoneNumber:l,userInformation:o}),{register:I,setValue:Z,watch:_,control:k,handleSubmit:S,clearErrors:P,formState:O}=(0,i.Gc)(),{errors:j}=O,M=_("phoneNumberSelect"),A=_("phoneNumberInput"),L=o.memberInfo.contacts.mobile,T=L.length>0;return s.createElement(x,{errorMessage:N,handleCloseErrorToast:w,isErrorShown:h,onCloseModal:c},s.createElement("form",{onSubmit:S(E)},s.createElement("div",{className:"flex flex-col items-center"},s.createElement(f.Z,{height:"auto",width:"320px"}),s.createElement("div",{className:"my-md"},s.createElement("span",{className:"font-kaidee text-body-3 font-bold text-p100"},"กรุณาตรวจสอบเบอร์โทรที่คุณต้องการให้ผู้ขายติดต่อกลับ")),T&&s.createElement(s.Fragment,null,L.map(e=>s.createElement(g,{key:e.value,isSelected:M===e.value,onSelect(){A&&Z("phoneNumberInput",""),P(),Z("phoneNumberSelect",e.value)},phoneNumber:e.value})),s.createElement("div",{className:"my-md flex justify-center"},s.createElement("span",{className:"text-body-5 text-sd025"},"หรือ กรอกเบอร์โทรอื่น"))),s.createElement(i.Qr,{control:k,name:"phoneNumberInput",render(e){var{field:{onChange:t,value:r}}=e;return s.createElement(p.Z,(0,u.Z)({},I("phoneNumberInput"),{"aria-label":"เบอร์โทรศัพท์",error:Boolean(j.phoneNumberInput),fullWidth:!0,maxLength:10,onChange(e){M&&Z("phoneNumberSelect",""),t(e.target.value)},placeholder:"08xxxxxxxx",type:"tel",value:r}))},rules:{maxLength:{message:"`เบอร์ติดต่อไม่ถูกต้อง",value:10},minLength:{message:"เบอร์ติดต่อไม่ถูกต้อง",value:9},pattern:{message:"กรุณากรอกเบอร์ติดต่อให้ถูกต้อง",value:/^[0]{1}[0-9]{7,10}$/},required:A}}),s.createElement(d.ZP,{className:"mt-lg",fullWidth:!0},y?s.createElement(m.e1,{size:"12px"}):"ยืนยัน"))))},O=r(96983),j=r(57008),M=r(94966),A=e=>{var t=e.target;if(t instanceof HTMLInputElement){var r=t.previousElementSibling;if("Backspace"!==e.key||""!==t.value)return;r instanceof HTMLInputElement&&r.focus()}},L=r(59037),T=(l=(0,c.Z)(function*(e,t,r){return yield(0,L.Z)({mobileNo:e,otp:t,type:2},{memberId:r.memberId,privateToken:r.ac})}),function(e,t,r){return l.apply(this,arguments)}),D=e=>e instanceof HTMLInputElement,V=e=>{if(""!==e.target.value){var t=e.target.nextElementSibling;D(t)&&t.focus()}},R=e=>{var t,r,{telephoneNumber:a,userInformation:n,onSuccessValidateOtp:l}=e,{0:o,1:u}=(0,s.useState)(""),{0:m,1:d}=(0,s.useState)(!1),{setValue:p,handleSubmit:f,watch:b}=(0,i.cI)({defaultValues:{otpValue:[]}}),v=b("otpValue"),h=(e,t)=>{var r=v;r[t]=e.target.value,p("otpValue",r),V(e)},g=(t=(0,c.Z)(function*(e){d(!0);try{var t=yield T(a,e.otpValue.join(""),n);if("success"!==t.status){u(t.message),d(!1);return}yield l(),d(!1)}catch(r){u("ระบบไม่สามารถให้บริการได้ในขณะนี้"),d(!1)}}),function(e){return t.apply(this,arguments)}),y=(r=(0,c.Z)(function*(e){d(!0),e.preventDefault();try{var t=yield S(a,n);if("success"!==t.status&&t.message){u(t.message),d(!1);return}u(""),d(!1)}catch(r){u("ระบบไม่สามารถให้บริการได้ในขณะนี้"),d(!1)}}),function(e){return r.apply(this,arguments)});return{errorMessage:o,handleFormSubmit:g,handleOnChange:h,handleRequestOtp:y,handleSubmit:f,isLoading:m,otpValue:v,setErrorMessage:u}},W=e=>{var{telephoneNumber:t,userInformation:r,onSuccessValidateOtp:a,onClickBack:n,onCloseModal:l,otpAmount:o=6}=e,{isLoading:i,errorMessage:c,otpValue:u,handleFormSubmit:d,handleSubmit:p,setErrorMessage:f,handleOnChange:b,handleRequestOtp:v}=R({onSuccessValidateOtp:a,telephoneNumber:t,userInformation:r});return s.createElement("form",{onSubmit:p(d)},s.createElement("div",{className:"relative bg-sl100 px-lg py-xl text-center md:w-[616px]"},i&&s.createElement("div",{className:"absolute top-0 left-0 flex h-full w-full items-center justify-center bg-sl100 opacity-70"},s.createElement(m.e1,{color:j.w.P100})),s.createElement(y.Z,{isShown:Boolean(c),mode:"error",onClose:()=>f(""),position:"bottom-center"},c),s.createElement("div",{className:"absolute right-md top-md cursor-pointer p-sm",onClick:l},s.createElement(E.Z,{height:"24px",width:"24px"})),s.createElement("div",{className:"absolute left-md top-md cursor-pointer p-sm",onClick:n},s.createElement(M.Z,{height:"24px",width:"24px"})),s.createElement("div",{className:"font-kaidee text-body-3 font-bold"},"กรอกรหัสยืนยัน"),s.createElement("div",{className:"my-lg flex justify-center"},Array(o).fill("").map((e,t)=>s.createElement("input",{key:t,"aria-label":"otp-".concat(t),className:"form-control m-2 h-4xl w-2xl rounded-sm border border-sl150 text-center focus:border-sl100",maxLength:1,onChange:e=>b(e,t),onFocus:e=>e.target.select(),onKeyDown:e=>A(e),pattern:"\\d{1}",type:"text",value:u[t]}))),s.createElement("div",{className:"mb-lg text-body-4 text-sd075"},"พิมพ์รหัสที่ส่งมาทาง SMS เบอร์ ",s.createElement("span",{className:"font-bold"},t),s.createElement("br",null)," (รหัสใช้ได้เพียงครั้งเดียว)"),s.createElement("div",{className:"h-[192px] text-body-5 text-sd025"},"ถ้าไม่ได้รับ SMS รหัสยืนยันภายใน 5 นาที ",s.createElement("br",null)," สามารถขอรหัสใหม่ หรือ ติดต่อทีมงาน"),s.createElement("div",{className:"grid grid-cols-2 gap-md"},s.createElement(O.Z,{fullWidth:!0,mode:"outlined",onClick:v},"ขอรหัสใหม่"),s.createElement(O.Z,{fullWidth:!0,type:"submit"},"ยืนยัน"))))},B=e=>{var{adId:t,categoryId:r,categoryRootId:a,sellerId:n,sellerPhoneNumber:l,userInformation:o,onClose:u,handleOnSuccess:m}=e,{0:d,1:p}=(0,s.useState)(!1),{watch:f}=(0,i.Gc)(),b=f("phoneNumberInput");return d?s.createElement(W,{onClickBack:()=>p(!1),onCloseModal:u,onSuccessValidateOtp:(0,c.Z)(function*(){yield Z({adId:t,buyerPhoneNumber:b,categoryId:r,categoryRootId:a,sellerId:n,sellerPhoneNumber:l,userInformation:o}),m()}),telephoneNumber:b,userInformation:o}):s.createElement(P,{adId:t,categoryId:r,categoryRootId:a,onCloseModal:u,onGenerateOtp:()=>p(!0),onSuccess:m,sellerId:n,sellerPhoneNumber:l,userInformation:o})},F=r(84752),U=e=>{var{onClose:t}=e,{getValues:r}=(0,i.Gc)(),a=r("phoneNumberSelect"),n=r("phoneNumberInput");return s.createElement("div",{className:"relative bg-sl100 px-lg py-lg"},s.createElement("div",{className:"absolute left-0 -top-5xl flex w-full justify-center"},s.createElement("div",{className:"rounded-full bg-sl100 p-xl"},s.createElement(F.Z,{height:"100px",width:"100px"}))),s.createElement("div",{className:" relative py-md text-center"},s.createElement("div",{className:"mt-5xl font-kaidee text-title-7 font-bold text-sd125"},"แจ้งผู้ขายให้ติดต่อคุณแล้ว"),s.createElement("div",{className:"pt-md text-body-3"},"ผู้ขายจะติดต่อกลับหาคุณที่เบอร์",s.createElement("span",{className:"ml-sm font-bold"},a||n))),s.createElement(d.ZP,{className:"mt-md",fullWidth:!0,onClick:t},"ตกลง"))},G=e=>{var{adId:t,categoryId:r,categoryRootId:a,sellerId:n,sellerPhoneNumber:l,userInformation:o,onClose:i}=e,{0:c,1:u}=(0,s.useState)(!1);return c?s.createElement(U,{onClose:i}):s.createElement(B,{adId:t,categoryId:r,categoryRootId:a,handleOnSuccess:()=>u(!0),onClose:i,sellerId:n,sellerPhoneNumber:l,userInformation:o})},K=e=>{var{adId:t,categoryId:r,categoryRootId:a,sellerId:n,sellerPhoneNumber:l,userInformation:c,onClose:u}=e,m=c.memberInfo.contacts.mobile.find(e=>"verify"===e.status),d=(0,i.cI)({defaultValues:{phoneNumberInput:"",phoneNumberSelect:(null==m?void 0:m.value)||""},reValidateMode:"onSubmit"});return s.createElement(i.RV,d,s.createElement(o.Z,{onClose:u},s.createElement(G,{adId:t,categoryId:r,categoryRootId:a,onClose:u,sellerId:n,sellerPhoneNumber:l,userInformation:c})))}},91567:function(e,t,r){var a,n=r(68930),l=r(30983),o=r(8565),s=r(79942);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var u=(a=(0,l.Z)(function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=yield(0,o.Z)("/pages/ad/".concat(e),c(c({},t),{},{profilerLabel:"Server.API.getPageAd"}));return(0,s.Z)(r)}),function(e){return a.apply(this,arguments)});t.Z=u},33835:function(e,t,r){var a,n=r(30983),l=r(46215),o=(a=(0,n.Z)(function*(e,t){try{var{sellerId:r,sellerPhoneNumber:a,buyerId:n,buyerPhoneNumber:o,adId:s,popUpName:i,roomId:c,vertical:u}=t;return yield(0,l.Z)("/chat/pop_up_event",{event_parameter:{ad_id:s,answers:["yes"],buyer_info:{member_id:n,mobile_number:o},room_id:c,seller_info:{member_id:r,mobile_number:a},vertical:u},pop_up_name:i},{memberId:e.memberId,privateToken:e.ac})}catch(m){throw console.error("An error occurred postToPopUpEventApi error=".concat(JSON.stringify(m))),m}}),function(e,t){return a.apply(this,arguments)});t.Z=o},79942:function(e,t,r){r.d(t,{Z:function(){return v}});var a,n,l=r(45343),o=r(22589);(a=n||(n={})).Amount="AMOUNT",a.Percent="PERCENT";var s=e=>{var t;return t="AMOUNT"===e.type?n.Amount:n.Percent,{type:t,value:e.value}},i=e=>({applicableCategoryIds:e.applicable_category_ids,expireDate:e.expire_datetime,moreDetails:e.more_details}),c=e=>{var{code:t,quantity:r,discount:a,terms:n,campaign_id:l}=e;return{campaignId:l,code:t,discount:s(a),nameEn:"Free listing fee",nameTh:"ลงประกาศฟรี",quantity:r,termAndCondition:i(n)}},u=e=>{var t,{package_id:r,egg:a,suggest_vouchers:n,qualified_campaign_ids:l}=e;return{egg:a,packageId:r,qualifiedCampaignIds:null!=l?l:[],suggest:null!==(t=null==n?void 0:n.map(c))&&void 0!==t?t:[],type:e.type}},m=e=>{var{packages:t,no_package_reason:r}=e;return{noPackageReason:null!=r?r:void 0,packages:t?t.map(e=>u(e)):[]}},d=e=>{var t,r;return{fullMessage:null!==(t=e.full_message)&&void 0!==t?t:"",shortMessage:null!==(r=e.short_message)&&void 0!==r?r:""}},p=r(78684),f=e=>{var{ads:t,see_more_url:r}=e;return{ads:t.map((e,t)=>(0,p.Z)({ad:e,ad_type:"std",position:t,supplementary:{ad_favorite_status:!1}})),seeMoreUrl:null==r?void 0:r.replace(/https:\/\/www.kaidee.com/,"")}},b=e=>{var t;return{adFavoriteStatus:e.ad_favorite_status,chatMacro:Array.isArray(t=e.chat_macro)?t.map(String):[],listingFeePackage:e.listing_fee_packages?m(e.listing_fee_packages):void 0,listingStatus:d(e.listing_status),owner:e.ad_owner?(0,o.Z)(e.ad_owner):void 0,relatedAds:f(e.related_ads)}},v=e=>({ad:(0,l.Z)(e.ad),supplementary:b(e.supplementary)})},57496:function(e,t,r){r.d(t,{Qj:function(){return a.Z},ZP:function(){return n.Z}});var a=r(89314);r(89709);var n=r(96983)},92998:function(e,t,r){var a=r(26327),n=r(81748),l=(0,a.iv)(["width:16px;height:16px;cursor:pointer;position:relative;-webkit-appearance:none;border:1px solid ",";border-radius:50%;outline:none;margin-right:",";margin-top:0;&:checked:before{content:'';display:block;position:relative;width:10px;height:10px;border-radius:50%;left:",";top:",";background:",";}&:disabled{border:1px solid ",";&:checked:before{background:",";}}"],n.wL.P100,n.Ki.Medium,n.Ki.XXSmall,n.Ki.XXSmall,n.wL.P100,n.wL.SD010,n.wL.SD010);t.Z=l}}]);